# Set user up to match current user.
# use $VIRUAL_ENV to get the directory of virtual environment
# volume mount the $VIRUAL_ENV mirroed in docker container
# set the environment the same.
# add $VIRUAL_ENV to the PATH of the docker container






PORT=$1
HOME=/home/`whoami`
if [ "$VIRTUAL_ENV" == "" ]
    then
    echo "A Virtual environment needs to be sourced to be bridged."
    exit 0
fi

if [ "$PORT" == "" ]
    then
    echo "No port specified, using default of 8888"
    PORT=8888
fi

echo "Bridging port [${PORT}] with jupyter default [8888]"
echo "Bridging [$HOME]"
echo "Bridging [$VIRTUAL_ENV]"

docker run \
    -it\
    --rm \
    --gpus '"device=0"' \
    -e VIRTUAL_ENV \
    -e PATH \
    -p ${PORT}:8888 \
    -v "${HOME}":${HOME} \
    ezcuda bash
    # --entrypoint "jupyter notebook --ip=0.0.0.0 --no-browser --allow-root"
    # jupyter notebook --no-browser